# ‡∏ä‡∏µ‡πâ‡πÅ‡∏à‡∏á Workflow ‡∏£‡∏∞‡∏ö‡∏ö Booking ‡πÅ‡∏•‡∏∞ Payment

## Workflow ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

```
1. Guest ‡∏à‡∏≠‡∏á
   ‚Üì
   Status: PendingPayment
   Payment: none (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô)
   ‚Üì ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô: /admin/reception ‚Üí "‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô"

2. Guest ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
   ‚Üì
   Status: PendingPayment
   Payment: pending (‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö)
   ‚Üì ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô: /admin/reception ‚Üí "‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô" (‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô)

3. Admin ‡∏Å‡∏î "‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥" ‡πÉ‡∏ô Reception
   ‚Üì ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢: ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‚úÖ
   ‚Üì ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥:
   ‚Üì   - ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å confirm_booking() ‚Üí booking.status = 'Confirmed'
   ‚Üì   - ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï payment_proofs.status = 'approved'
   ‚Üì   - ‡∏•‡∏î available_rooms ‡πÉ‡∏ô inventory
   ‚Üì
   Status: Confirmed (‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß)
   Payment: approved (‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß) ‚úÖ
   ‚Üì ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô: /admin/checkin ‚Üí "Arrivals"

4. Receptionist assign room + check-in
   ‚Üì
   Status: CheckedIn (‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß)
   Payment: approved (‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß)
   ‚Üì ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô: /admin/checkin ‡πÅ‡∏•‡∏∞ /admin/checkout

5. Check-out
   ‚Üì
   Status: Completed (‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô)
```

## ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß (‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á)

### ‚úÖ ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î "‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥" ‡πÉ‡∏ô Reception:

**Backend** (`payment_proof_repository.go`):
```go
// 1. ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å confirm_booking()
err = tx.QueryRow(ctx, `SELECT * FROM confirm_booking($1)`, bookingID).Scan(...)
// ‚Üí ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô booking.status = 'Confirmed'
// ‚Üí ‡∏•‡∏î available_rooms

// 2. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï payment proof
_, err = tx.Exec(ctx, `
    UPDATE payment_proofs 
    SET status = 'approved',  // ‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß
        notes = COALESCE($2, notes),
        updated_at = NOW() 
    WHERE booking_id = $1
`, bookingID, notes)
```

### ‚úÖ ‡πÉ‡∏ô Check-in Page ‡πÅ‡∏™‡∏î‡∏á:

**Query** (`booking_repository.go`):
```sql
SELECT 
    b.status,  -- Confirmed
    COALESCE(pp.status, 'none') as payment_status,  -- approved
    ...
FROM bookings b
LEFT JOIN payment_proofs pp ON b.booking_id = pp.booking_id
WHERE bd.check_in_date = $1
  AND b.status IN ('Confirmed', 'CheckedIn')
```

**UI** (`checkin/page.tsx`):
```tsx
{/* Booking Status */}
{arrival.status === 'Confirmed' && (
  <span className="... bg-blue-100">
    ‚úì ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß
  </span>
)}

{/* Payment Status */}
{arrival.payment_status === 'approved' && (
  <span className="... bg-green-100">
    üí∞ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß  // ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
  </span>
)}
```

## ‡∏™‡∏£‡∏∏‡∏õ

### ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß:

1. ‚úÖ **Approve = ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô**
   - `payment_proofs.status = 'approved'`
   - `booking.status = 'Confirmed'`

2. ‚úÖ **Check-in ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô**
   - Badge: "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß" (booking status)
   - Badge: "üí∞ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß" (payment status)

3. ‚úÖ **Workflow ‡πÅ‡∏¢‡∏Å‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô**
   - Reception: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
   - Check-in: assign room ‡πÅ‡∏•‡∏∞ check-in

### ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏≠‡∏∞‡πÑ‡∏£ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞:

- Backend ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï `payment_proofs.status = 'approved'` ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
- Frontend ‡πÅ‡∏™‡∏î‡∏á payment status badge ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
- Workflow ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£

## ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô

```bash
# 1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà /admin/reception
# 2. ‡πÅ‡∏ó‡πá‡∏ö "‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô"
# 3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å booking ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
# 4. ‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥"
# 5. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà /admin/checkin
# 6. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÅ‡∏™‡∏î‡∏á:
#    - Badge: "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß" (‡∏™‡∏µ‡∏ü‡πâ‡∏≤)
#    - Badge: "üí∞ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß" (‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß)
```

**Expected Result:**
- ‚úÖ ‡πÅ‡∏™‡∏î‡∏á 2 badges
- ‚úÖ Payment status = "‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß"
- ‚úÖ Receptionist ‡πÄ‡∏´‡πá‡∏ô‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏ß‡πà‡∏≤ booking ‡∏ô‡∏µ‡πâ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß
- ‚úÖ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ assign room ‡πÅ‡∏•‡∏∞ check-in ‡πÑ‡∏î‡πâ

## ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏

‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß:
- **Approve** = ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÅ‡∏Ñ‡πà‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô booking)
- **Payment Status** = ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏ß‡πà‡∏≤ "‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß"
- **Workflow** = ‡πÅ‡∏¢‡∏Å‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á reception ‡πÅ‡∏•‡∏∞ check-in

‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°! üéâ
